<!DOCTYPE html>
<html lang="ko" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>대출 상환 비교 플래너 | Debt Payoff Planner</title>
  <meta name="description" content="한국 대출 상환 방식을 한눈에 비교하세요. 원리금균등, 원금균등, 만기일시, 거치식 상환의 이자 차이를 즉시 확인할 수 있습니다." />
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>
  <!-- ─── Header ─── -->
  <header class="app-header">
    <div class="header-controls">
      <button class="theme-toggle" id="themeToggle" title="테마 전환">🌙</button>
    </div>
    <h1><span class="icon">🏦</span>대출 상환 비교 플래너</h1>
    <p>상환 방식별 이자 차이를 한눈에 비교하세요</p>
  </header>

  <main class="app-container">
    <!-- ─── Input Section ─── -->
    <section class="card" id="input-section">
      <h2 class="section-title"><span class="icon">📝</span>대출 정보 입력</h2>

      <div class="input-grid">
        <div class="input-group">
          <label for="loanAmount">대출 원금</label>
          <div class="input-suffix">
            <input type="number" id="loanAmount" value="30000" min="100" step="100" placeholder="30000" />
            <span>만원</span>
          </div>
        </div>

        <div class="input-group">
          <label for="interestRate">연이자율</label>
          <div class="input-suffix">
            <input type="number" id="interestRate" value="3.5" min="0" max="30" step="0.1" placeholder="3.5" />
            <span>%</span>
          </div>
        </div>

        <div class="input-group">
          <label for="loanPeriod">대출 기간</label>
          <div class="input-suffix">
            <input type="number" id="loanPeriod" value="30" min="1" max="50" step="1" placeholder="30" />
            <span>년</span>
          </div>
        </div>
      </div>

      <!-- Method Selection -->
      <div class="method-selection">
        <p class="section-subtitle">비교할 상환 방식을 선택하세요</p>
        <div class="method-chips">
          <label class="method-chip active" style="--chip-color: #3b82f6" data-method="equalPayment">
            <input type="checkbox" value="equalPayment" checked />
            <span class="chip-dot" style="background: #3b82f6"></span>
            원리금균등상환
          </label>
          <label class="method-chip active" style="--chip-color: #10b981" data-method="equalPrincipal">
            <input type="checkbox" value="equalPrincipal" checked />
            <span class="chip-dot" style="background: #10b981"></span>
            원금균등상환
          </label>
          <label class="method-chip active" style="--chip-color: #f59e0b" data-method="bullet">
            <input type="checkbox" value="bullet" checked />
            <span class="chip-dot" style="background: #f59e0b"></span>
            만기일시상환
          </label>
          <label class="method-chip" style="--chip-color: #ef4444" data-method="grace">
            <input type="checkbox" value="grace" />
            <span class="chip-dot" style="background: #ef4444"></span>
            거치식상환
          </label>
        </div>

        <!-- Grace Period Input (hidden by default) -->
        <div class="grace-option hidden" id="graceOption">
          <label for="gracePeriod">거치 기간</label>
          <div class="input-suffix">
            <input type="number" id="gracePeriod" value="2" min="1" max="10" step="1" />
            <span>년</span>
          </div>
        </div>
      </div>

      <button class="btn-calculate" id="btnCalculate">
        <span>📊</span> 상환 비교 계산하기
      </button>
    </section>

    <!-- ─── Results Section ─── -->
    <section id="results-section">
      <!-- Summary Cards -->
      <div class="section-header-flex">
        <h2 class="section-title"><span class="icon">📋</span>상환 방식 비교 요약</h2>
        <div class="export-actions">
          <button class="btn-export" id="btnExportImage" title="이미지로 저장">🖼️</button>
          <button class="btn-export" id="btnExportCSV" title="CSV로 다운로드">📥</button>
        </div>
      </div>
      <div class="summary-grid" id="summaryGrid"></div>

      <!-- Interest Comparison Bars -->
      <div class="card interest-compare-section" style="margin-top: 1.25rem">
        <h3 class="section-title"><span class="icon">💰</span>총이자 비교</h3>
        <div class="interest-bars" id="interestBars"></div>
      </div>

      <!-- Charts -->
      <div class="chart-card">
        <div class="chart-tabs">
          <button class="chart-tab active" data-chart="payment">월 상환액 추이</button>
          <button class="chart-tab" data-chart="balance">대출 잔액 변화</button>
          <button class="chart-tab" data-chart="interest">이자 비중 변화</button>
        </div>
        <div class="chart-container">
          <canvas id="mainChart"></canvas>
        </div>
      </div>

      <!-- Schedule Table -->
      <div class="card schedule-section">
        <div class="schedule-controls">
          <h3 class="section-title" style="margin-bottom: 0"><span class="icon">📅</span>월별 상환 스케줄</h3>
          <select class="schedule-method-select" id="scheduleMethodSelect"></select>
        </div>
        <div class="table-wrapper">
          <table class="schedule-table" id="scheduleTable">
            <thead>
              <tr>
                <th>회차</th>
                <th>월 상환액</th>
                <th>원금</th>
                <th>이자</th>
                <th>대출 잔액</th>
              </tr>
            </thead>
            <tbody id="scheduleBody"></tbody>
          </table>
        </div>
        <div id="loadMoreContainer" class="load-more-container hidden">
          <button class="btn-load-more" id="btnLoadMore">상세 스케줄 더 보기 (전체 회차)</button>
        </div>
      </div>

      <!-- Early Repayment Simulation -->
      <div class="card early-repayment-section">
        <h3 class="section-title"><span class="icon">⚡</span>중도상환 시뮬레이션</h3>
        <div class="early-inputs">
          <div class="input-group">
            <label for="earlyMethod">상환 방식</label>
            <select id="earlyMethod"></select>
          </div>
          <div class="input-group">
            <label for="earlyMonth">중도상환 시점</label>
            <div class="input-suffix">
              <input type="number" id="earlyMonth" value="12" min="1" step="1" />
              <span>개월 후</span>
            </div>
          </div>
          <div class="input-group">
            <label for="earlyAmount">중도상환 금액</label>
            <div class="input-suffix">
              <input type="number" id="earlyAmount" value="5000" min="100" step="100" />
              <span>만원</span>
            </div>
          </div>
          <div class="input-group">
            <label for="earlyFeeRate">중도상환 수수료율</label>
            <div class="input-suffix">
              <input type="number" id="earlyFeeRate" value="1.2" min="0" max="5" step="0.1" />
              <span>%</span>
            </div>
          </div>
        </div>
        <button class="btn-simulate" id="btnSimulate">
          <span>🔍</span> 시뮬레이션 실행
        </button>
        <div class="early-result" id="earlyResult">
          <h4 style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem">💡 중도상환 효과</h4>
          <div class="early-comparison" id="earlyComparison"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- ─── Footer ─── -->
  <footer class="app-footer">
    <p>ⓒ Dunam · <a href="https://cafe.naver.com/retireclass" target="_blank"
        rel="noopener">cafe.naver.com/retireclass</a></p>
    <p style="margin-top: 0.25rem">본 프로그램은 자유롭게 사용 및 배포가 가능합니다. ✅</p>
  </footer>



  <script src="js/calculator.js"></script>
  <script src="js/chart.js"></script>
  <script src="js/app.js"></script>
</body>

</html>